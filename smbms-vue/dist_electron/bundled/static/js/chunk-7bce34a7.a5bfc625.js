(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7bce34a7"],{3846:function(t,e,s){s("9e1e")&&"g"!=/./g.flags&&s("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:s("0bfb")})},"6b54":function(t,e,s){"use strict";s("3846");var o=s("cb7c"),i=s("0bfb"),n=s("9e1e"),a="toString",r=/./[a],c=function(t){s("2aba")(RegExp.prototype,a,t,!0)};s("79e5")((function(){return"/a/b"!=r.call({source:"a",flags:"b"})}))?c((function(){var t=o(this);return"/".concat(t.source,"/","flags"in t?t.flags:!n&&t instanceof RegExp?i.call(t):void 0)})):r.name!=a&&c((function(){return r.call(this)}))},"86a6":function(t,e,s){"use strict";s("e171")},"9ed6":function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"login-container",staticStyle:{"background-image":"url(./img/bg.jpg)"}},[s("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:t.loginForm,rules:t.loginRules,"auto-complete":"on","label-position":"left"}},[s("div",{staticClass:"title-container"},[s("h3",{staticClass:"title"},[t._v(t._s(t.$t("login.title")))]),t._v(" "),s("lang-select",{staticClass:"set-language"})],1),t._v(" "),s("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.changeLoginType},model:{value:t.qrcode.activeName,callback:function(e){t.$set(t.qrcode,"activeName",e)},expression:"qrcode.activeName"}},[s("el-tab-pane",{attrs:{label:"账号密码登录",name:"first"}},[s("el-form-item",{attrs:{prop:"username"}},[s("span",{staticClass:"svg-container"},[s("svg-icon",{attrs:{"icon-class":"user"}})],1),t._v(" "),s("el-input",{attrs:{placeholder:t.$t("login.username"),name:"username",type:"text","auto-complete":"on"},model:{value:t.loginForm.username,callback:function(e){t.$set(t.loginForm,"username",e)},expression:"loginForm.username"}})],1),t._v(" "),s("el-form-item",{attrs:{prop:"password"}},[s("span",{staticClass:"svg-container"},[s("svg-icon",{attrs:{"icon-class":"password"}})],1),t._v(" "),s("el-input",{attrs:{type:t.pwdType,placeholder:t.$t("login.password"),name:"password","auto-complete":"on"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleLogin(e)}},model:{value:t.loginForm.password,callback:function(e){t.$set(t.loginForm,"password",e)},expression:"loginForm.password"}}),t._v(" "),s("span",{staticClass:"show-pwd",on:{click:t.showPwd}},[s("svg-icon",{attrs:{"icon-class":"eye"}})],1)],1),t._v(" "),s("el-button",{staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{loading:t.loading,type:"primary"},nativeOn:{click:function(e){return e.preventDefault(),t.handleLogin(e)}}},[t._v(" "+t._s(t.$t("login.logIn"))+" ")]),t._v(" "),s("div",{staticStyle:{position:"relative"}},[s("div",{staticClass:"tips"},[s("span",[t._v(t._s(t.$t("login.username"))+" : admin")]),t._v(" "),s("span",[t._v(t._s(t.$t("login.password"))+" : admin")])]),t._v(" "),s("div",{staticClass:"tips"},[s("span",{staticStyle:{"margin-right":"18px"}},[t._v(t._s(t.$t("login.username"))+" : developer")]),t._v(" "),s("span",[t._v(t._s(t.$t("login.password"))+" : developer")])])])],1)],1)],1)],1)},i=[],n=(s("6b54"),s("61f7")),a=s("fa7d"),r=s("c24f"),c=s("1131"),l={name:"login",components:{LangSelect:c["default"]},data(){const t=(t,e,s)=>{Object(n["isvalidUsername"])(e)?s():s(new Error(this.$t("login.errorAccount")))},e=(t,e,s)=>{e.length<3?s(new Error(this.$t("login.errorPassword"))):s()};return{qrcode:{activeName:"first",showAppdownload:!1,imgUrl:"",uuid:"",resultStatus:"",msg:"请使用smbms-uniapp 扫码登录"},loginForm:{username:"",password:""},loginRules:{username:[{required:!0,trigger:"blur",validator:t}],password:[{required:!0,trigger:"blur",validator:e}]},loading:!1,pwdType:"password",redirect:"/"}},mounted(){this.init(),this.getQrcode()},methods:{init(){const t=this.$route.query.redirect;t&&(this.redirect=t)},changeLoginType(t){"second"===this.qrcode.activeName&&(this.getQrcode(),this.getQrcodeResult())},uuid(){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},showAppdownload(){this.qrcode.showAppdownload=!0},hideAppdownload(){this.qrcode.showAppdownload=!1},getQrcode(){this.qrcode.uuid=this.uuid();const t=Object(a["getApiUrl"])()+"/account/qrcode/generate?uuid="+this.qrcode.uuid;console.log("getQrcode",t),this.qrcode.imgUrl=t},refreshQrcode(){this.getQrcode(),this.qrcode.resultStatus="",this.getQrcodeResult()},getQrcodeResult(){if("second"===this.qrcode.activeName){const t=this;this.sleep(1e3).then(()=>{Object(r["getQrcodeStatus"])({uuid:t.qrcode.uuid}).then(e=>{console.log("扫描结果",e),this.qrcode.resultStatus=e.data.status,"invalid"===e.data.status&&(this.qrcode.showAppdownload=!1,t.qrcode.msg="二维码已过期"),"success"===e.data.status&&(this.qrcode.showAppdownload=!1,this.qrcode.msg="扫描成功，自动登录中",this.loading=!0,this.$store.dispatch("user/autoLogin",{token:e.data.token}).then(()=>{this.loading=!1,this.$router.push({path:this.redirect})}).catch(t=>{this.qrcode.msg="登录失败",this.loading=!1})),"second"===t.qrcode.activeName&&"undo"===e.data.status&&t.getQrcodeResult()}).catch(t=>{console.log("err",t)})})}},sleep(t){return new Promise(e=>setTimeout(e,t))},showPwd(){"password"===this.pwdType?this.pwdType="":this.pwdType="password"},handleLogin(){this.$refs.loginForm.validate(t=>{if(!t)return!1;this.loading=!0,this.$store.dispatch("user/login",this.loginForm).then(()=>{this.loading=!1,this.$router.push({path:this.redirect})}).catch(t=>{this.loading=!1})})}}},d=l,u=(s("86a6"),s("2877")),p=Object(u["a"])(d,o,i,!1,null,null,null);e["default"]=p.exports},e171:function(t,e,s){},fa7d:function(t,e,s){"use strict";s.r(e),s.d(e,"getApiUrl",(function(){return i}));const o="http://10.15.120.205:8080";function i(){return o}}}]);